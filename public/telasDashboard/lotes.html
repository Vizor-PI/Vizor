<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Criar Lote</title>
</head>

<body onload="dadosLote()">
    <div id="container">
        <h1 id="lotes">Lotes</h1>
        <p id="quantidadeLotes">Quantidade de Lotes:</p>
        <a href="criarLote.html"><button>Adicionar lotes</button></a>

        <input placeholder="Pesquisar por nome" type="text" id="filtroNome" oninput="filtrarUsuarios()" />

        <div id="card">
            <p id="idLote">ID:</p>
            <p id="dataLote">Data:</p>
            <p id="qtdMaquinas">Qtd máquinas:</p>
        </div>

    </div>

</body>

</html>

<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

<script>
    function dadosLote() {
        const id = sessionStorage.ID_USUARIO;

        fetch(`/lote/buscar/`, {
            method: "GET",
            headers: {
                "Content-Type": "application/json",
            },
        })
            .then(async (response) => {
                if (response.ok) {
                    const text = await response.text();
                    return text ? JSON.parse(text) : null;
                } else {
                    console.error("Nenhum dado encontrado");
                    return null;
                }
            })
            .then((resposta) => {
                if (resposta && resposta.length > 0) {
                    document.getElementById("quantidadeLotes").textContent = `Quantidade de Lotes: ${resposta.length}`;
                    document.getElementById("idLote").textContent = `ID: ${resposta[0].id || "ID não encontrado"}`;

                    const dataFabricacao = new Date(resposta[0].dataFabricacao);
                    const dataFormatada = dataFabricacao.toLocaleDateString('pt-BR');
                    document.getElementById("dataLote").textContent = `Data: ${dataFormatada || "Data não encontrada"}`;

                    document.getElementById("qtdMaquinas").textContent = `Qtd máquinas: ${resposta[0].idMiniPC || "Quantidade não encontrada"}`;
                }
            })
            .catch((erro) => {
                console.error("Erro na requisição:", erro);
            });
    }

</script>